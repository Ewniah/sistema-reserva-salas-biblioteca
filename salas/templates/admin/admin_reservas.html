{% extends 'salas/base.html' %}

{% block title %}GestiÃ³n de Reservas{% endblock %}

{% block content %}
<div class="card">
    <div class="flex-between">
        <h2>ğŸ“‹ GestiÃ³n de Reservas</h2>
        <a href="{% url 'panel_admin' %}" class="btn btn-secondary">â† Volver al Panel</a>
    </div>
</div>

{% if reservas %}
    <div class="card">
        <div class="table-container">
            <table>
                <thead>
                    <tr>
                        <th>Sala</th>
                        <th>Reservante</th>
                        <th>RUT</th>
                        <th>Inicio</th>
                        <th>Fin</th>
                        <th>Estado</th>
                        <th>Acciones</th>
                    </tr>
                </thead>
                <tbody>
                    {% for reserva in reservas %}
                        <tr>
                            <td><strong>{{ reserva.sala.nombre }}</strong></td>
                            <td>{{ reserva.nombre_reservante }}</td>
                            <td>{{ reserva.rut }}</td>
                            <td>{{ reserva.fecha_hora_inicio|date:"d/m/Y H:i" }}</td>
                            <td>{{ reserva.fecha_hora_fin|date:"d/m/Y H:i" }}</td>
                            <td>
                                {% now "U" as current_time %}
                                {% if reserva.fecha_hora_fin|date:"U" >= current_time %}
                                    <span class="badge badge-success">âœ“ Activa</span>
                                {% else %}
                                    <span class="badge badge-secondary">âœ“ Finalizada</span>
                                {% endif %}
                            </td>
                            <td>
                                <div class="flex gap-1">
                                    {% now "U" as current_time %}
                                    {% if reserva.fecha_hora_fin|date:"U" >= current_time %}
                                        <a href="{% url 'admin_finalizar_reserva' reserva.id %}" 
                                           class="btn btn-warning btn-sm">
                                            â° Finalizar
                                        </a>
                                    {% endif %}
                                    <a href="{% url 'admin_eliminar_reserva' reserva.id %}" 
                                       class="btn btn-danger btn-sm">
                                        ğŸ—‘ï¸ Eliminar
                                    </a>
                                </div>
                            </td>
                        </tr>
                    {% endfor %}
                </tbody>
            </table>
        </div>
    </div>
{% else %}
    <div class="card text-center">
        <p style="font-size: 3rem; margin-bottom: 1rem;">ğŸ“­</p>
        <h3>No hay reservas registradas</h3>
        <p style="color: var(--gray);">AÃºn no se han realizado reservas en el sistema.</p>
    </div>
{% endif %}
{% endblock %}
